<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Orders Frontend</title>
    <style>
      body {
        font-family: sans-serif;
        margin: 2rem;
        background: #f4f4f4;
      }
      h1 {
        color: #333;
      }
      #orders {
        margin-top: 1rem;
        border-collapse: collapse;
        width: 100%;
      }
      #orders th,
      #orders td {
        padding: 8px 12px;
        border: 1px solid #ccc;
        text-align: left;
      }
      #orders th {
        background: #eee;
      }
      .filter {
        margin-bottom: 1rem;
      }
    </style>
  </head>
  <body>
    <h1>Orders Frontend</h1>
    <div class="filter">
      <label for="status">Filter by status:</label>
      <select id="status">
        <option value="">-- all --</option>
        <option value="new">new</option>
        <option value="paid">paid</option>
        <option value="shipped">shipped</option>
      </select>
      <button onclick="loadOrders()">Load Orders</button>
    </div>
    <table id="orders">
      <thead>
        <tr>
          <th>ID</th>
          <th>Customer</th>
          <th>Status</th>
          <th>Total</th>
          <th>Currency</th>
          <th>Created</th>
          <th>Updated</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      async function loadOrders() {
        const status = document.getElementById("status").value;
        let url = "{{BACKEND_URL}}/orders";
        if (status) {
          url += "?status=" + encodeURIComponent(status);
        }

        try {
          const res = await fetch(url);
          const data = await res.json();

          const tbody = document.querySelector("#orders tbody");
          tbody.innerHTML = "";
          data.forEach((o) => {
            const row = document.createElement("tr");
            row.innerHTML = `
            <td>${o.order_id}</td>
            <td>${o.customer_id}</td>
            <td>${o.status}</td>
            <td>${o.total_amount}</td>
            <td>${o.currency}</td>
            <td>${o.created_at}</td>
            <td>${o.updated_at}</td>
          `;
            tbody.appendChild(row);
          });
        } catch (err) {
          alert("Error loading orders: " + err);
        }
      }

      // auto-load on page open
      loadOrders();
    </script>
  </body>
</html>
