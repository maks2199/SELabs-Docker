# Этап 3. Монтирование — теория.

## 1. Монтирование директорий

### В Dockerfile / Docker Compose

```yaml
services:
  backend:
    volumes:
      - ./local_folder:/container_folder
```

- **`./local_folder`** — путь на вашей машине (хосте)
- **`/container_folder`** — путь внутри контейнера
- Используется для:

  - Доступа контейнера к локальным файлам
  - Сохранения данных между запусками контейнера
  - Подключения конфигураций, исходного кода, логов

### Примеры

```yaml
volumes:
  - ./data:/app/data # локальная папка data → внутрь контейнера
  - ./config:/app/config # конфиги приложения
```

- Любые изменения в `./data` сразу видны в контейнере и наоборот (bind mount)
- Если контейнер удалён, файлы на хосте сохраняются

---

## 2. Том (Volume)

### Объявление тома

```yaml
services:
  db:
    image: postgres:15
    volumes:
      - db-data:/var/lib/postgresql/data

volumes:
  db-data:
```

- **`db-data`** — имя тома, Docker сам создаёт его в хранилище Docker
- Используется для:

  - Постоянного хранения данных (например, базы данных)
  - Независимости от локальной файловой структуры
  - Совместного использования данных между контейнерами

### Отличия тома от bind mount

| Bind mount                           | Volume (том)                       |
| ------------------------------------ | ---------------------------------- |
| Привязан к конкретной папке на хосте | Docker управляет хранилищем        |
| Изменения сразу видны на хосте       | Хост напрямую не видит файлов      |
| Используется для разработки          | Используется для продакшена/данных |

---

## 3. Основные команды для работы с томами

```bash
docker volume ls             # список всех томов
docker volume inspect db-data # подробная информация о томе
docker volume rm db-data     # удалить том
docker compose down -v       # удалить тома вместе с контейнерами и сетями
```

---

## 4. Комбинирование директорий и томов

```yaml
services:
  backend:
    volumes:
      - ./app_logs:/app/logs # bind mount для логов
      - backend-data:/app/data # том для хранения данных приложения

volumes:
  backend-data:
```

- **Bind mount** — для локальной разработки и отладки
- **Volume** — для данных, которые должны сохраняться независимо от хоста
